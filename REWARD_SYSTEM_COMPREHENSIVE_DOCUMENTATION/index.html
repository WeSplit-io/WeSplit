
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="WeSplit - Split expenses socially, settle instantly with crypto">
      
      
        <meta name="author" content="WeSplit Team">
      
      
        <link rel="canonical" href="https://YOUR_USERNAME.github.io/WeSplit/REWARD_SYSTEM_COMPREHENSIVE_DOCUMENTATION/">
      
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Reward System Comprehensive Documentation - WeSplit Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reward-system-comprehensive-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="WeSplit Documentation" class="md-header__button md-logo" aria-label="WeSplit Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WeSplit Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reward System Comprehensive Documentation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="dark" data-md-color-primary="indigo" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/YOUR_USERNAME/WeSplit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    WeSplit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../index.md" class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../CORBITS_X402_INTEGRATION_PLAN.md" class="md-tabs__link">
          
  
  
  Corbits Integration

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../AUTH_CONFIG_STATUS/" class="md-tabs__link">
          
  
  
  Development

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../BADGE_SETUP_SUMMARY/" class="md-tabs__link">
          
  
  
  Features

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../QUICK_TEST_GUIDE/" class="md-tabs__link">
          
  
  
  Testing

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="WeSplit Documentation" class="md-nav__button md-logo" aria-label="WeSplit Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    WeSplit Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/YOUR_USERNAME/WeSplit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    WeSplit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Corbits Integration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Corbits Integration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CORBITS_X402_INTEGRATION_PLAN.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Integration Plan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Development
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Development
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AUTH_CONFIG_STATUS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Authentication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PHANTOM_INTEGRATION_PLAN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Phantom Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Features
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Features
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../BADGE_SETUP_SUMMARY/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Badges
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../REFERRAL_SYSTEM_COMPLETE.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Referrals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Testing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../QUICK_TEST_GUIDE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Test Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LOCAL_BUILD_SETUP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Local Build
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#executive-summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Executive Summary
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Executive Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Features
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overall-status" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overall Status
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="System Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Components
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration Files
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#points-sources" class="md-nav__link">
    <span class="md-ellipsis">
      
        Points Sources
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Points Sources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-transaction-rewards" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Transaction Rewards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-quest-completion-rewards" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Quest Completion Rewards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-split-participation-rewards" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Split Participation Rewards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-referral-rewards" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Referral Rewards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-badge-claim-rewards" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Badge Claim Rewards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-christmas-calendar-rewards" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Christmas Calendar Rewards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-admin-adjustments" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Admin Adjustments
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#claimable-assets" class="md-nav__link">
    <span class="md-ellipsis">
      
        Claimable Assets
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Claimable Assets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-badges" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Badges
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Badges">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#achievement-badges-progress-based" class="md-nav__link">
    <span class="md-ellipsis">
      
        Achievement Badges (Progress-Based)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-badges-redeem-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Event Badges (Redeem Code)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-profile-assets" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Profile Assets
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-wallet-backgrounds" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Wallet Backgrounds
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-source-of-truth" class="md-nav__link">
    <span class="md-ellipsis">
      
        Single Source of Truth
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-files_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration Files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#season-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Season Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reward-types" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reward Types
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reward Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fixed-points" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fixed Points
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#percentage-based" class="md-nav__link">
    <span class="md-ellipsis">
      
        Percentage-Based
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validation-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        Validation System
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Validation System">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validation-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Validation Functions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validation-runner" class="md-nav__link">
    <span class="md-ellipsis">
      
        Validation Runner
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running Validation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-guide" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Guide
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation Guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#awarding-transaction-points" class="md-nav__link">
    <span class="md-ellipsis">
      
        Awarding Transaction Points
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#awarding-split-participation-rewards" class="md-nav__link">
    <span class="md-ellipsis">
      
        Awarding Split Participation Rewards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tracking-referrals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tracking Referrals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syncing-user-actions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Syncing User Actions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-points" class="md-nav__link">
    <span class="md-ellipsis">
      
        Integration Points
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maintenance-guide" class="md-nav__link">
    <span class="md-ellipsis">
      
        Maintenance Guide
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Maintenance Guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-start-editing-rewards" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Start: Editing Rewards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helper-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Helper Functions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validation-rules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Validation Rules
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verification-status" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verification &amp; Status
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Verification &amp; Status">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#points-award-method-consolidation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Points Award Method Consolidation ✅
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validation-functions_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Validation Functions ✅
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#direct-database-updates" class="md-nav__link">
    <span class="md-ellipsis">
      
        Direct Database Updates ✅
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-points_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Integration Points ✅
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#critical-issues" class="md-nav__link">
    <span class="md-ellipsis">
      
        Critical Issues
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Critical Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#asset-placeholder-urls-critical" class="md-nav__link">
    <span class="md-ellipsis">
      
        ⚠️ Asset Placeholder URLs (CRITICAL)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Best Practices
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code-organization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Code Organization ✅
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Handling ✅
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-integrity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Integrity ✅
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      
        Logging &amp; Monitoring ✅
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-safety" class="md-nav__link">
    <span class="md-ellipsis">
      
        Type Safety ✅
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-blocking-operations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Non-Blocking Operations ✅
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#issue-changes-not-applying" class="md-nav__link">
    <span class="md-ellipsis">
      
        Issue: Changes not applying
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issue-validation-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        Issue: Validation errors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issue-wrong-reward-type" class="md-nav__link">
    <span class="md-ellipsis">
      
        Issue: Wrong reward type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issue-asset-urls-not-loading" class="md-nav__link">
    <span class="md-ellipsis">
      
        Issue: Asset URLs not loading
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issue-points-not-awarded" class="md-nav__link">
    <span class="md-ellipsis">
      
        Issue: Points not awarded
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-statistics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary Statistics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Summary Statistics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#integration-points_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Integration Points
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database-flags" class="md-nav__link">
    <span class="md-ellipsis">
      
        Database Flags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-coverage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Code Coverage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#action-items" class="md-nav__link">
    <span class="md-ellipsis">
      
        Action Items
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Action Items">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#completed" class="md-nav__link">
    <span class="md-ellipsis">
      
        Completed ✅
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pending" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pending ⚠️
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-locations" class="md-nav__link">
    <span class="md-ellipsis">
      
        File Locations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File Locations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-services" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Services
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-files_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration Files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validation-verification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Validation &amp; Verification
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Documentation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="reward-system-comprehensive-documentation">Reward System Comprehensive Documentation<a class="headerlink" href="#reward-system-comprehensive-documentation" title="Permanent link">&para;</a></h1>
<p><strong>Last Updated:</strong> 2024-12-19<br />
<strong>Status:</strong> ✅ <strong>Production Ready</strong> (with asset URL updates required)<br />
<strong>Version:</strong> 2.0</p>
<hr />
<h2 id="table-of-contents">Table of Contents<a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#executive-summary">Executive Summary</a></li>
<li><a href="#system-architecture">System Architecture</a></li>
<li><a href="#points-sources">Points Sources</a></li>
<li><a href="#claimable-assets">Claimable Assets</a></li>
<li><a href="#configuration-management">Configuration Management</a></li>
<li><a href="#validation-system">Validation System</a></li>
<li><a href="#implementation-guide">Implementation Guide</a></li>
<li><a href="#maintenance-guide">Maintenance Guide</a></li>
<li><a href="#verification--status">Verification &amp; Status</a></li>
<li><a href="#best-practices">Best Practices</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
</ol>
<hr />
<h2 id="executive-summary">Executive Summary<a class="headerlink" href="#executive-summary" title="Permanent link">&para;</a></h2>
<p>The WeSplit reward system is a comprehensive, season-based points and assets distribution system that rewards users for various actions including transactions, quests, splits, referrals, and special events.</p>
<h3 id="key-features">Key Features<a class="headerlink" href="#key-features" title="Permanent link">&para;</a></h3>
<ul>
<li>✅ <strong>Season-Based Rewards</strong>: 5 seasons with different reward structures</li>
<li>✅ <strong>Multiple Points Sources</strong>: Transactions, quests, splits, referrals, badges, calendar</li>
<li>✅ <strong>Claimable Assets</strong>: Badges, profile images, wallet backgrounds</li>
<li>✅ <strong>Centralized Configuration</strong>: Single source of truth for all reward values</li>
<li>✅ <strong>Comprehensive Validation</strong>: Automated validation for all configurations</li>
<li>✅ <strong>Partnership Support</strong>: Enhanced rewards for partnership users</li>
<li>✅ <strong>Referral System</strong>: Complete referral tracking and rewards</li>
</ul>
<h3 id="overall-status">Overall Status<a class="headerlink" href="#overall-status" title="Permanent link">&para;</a></h3>
<p><strong>Code Quality:</strong> ✅ <strong>Excellent</strong><br />
<strong>Architecture:</strong> ✅ <strong>Well-Designed</strong><br />
<strong>Data Integrity:</strong> ✅ <strong>Secure</strong><br />
<strong>Maintainability:</strong> ✅ <strong>High</strong></p>
<p><strong>Production Readiness:</strong> ✅ <strong>Ready</strong> (asset URLs need updating)</p>
<hr />
<h2 id="system-architecture">System Architecture<a class="headerlink" href="#system-architecture" title="Permanent link">&para;</a></h2>
<h3 id="core-components">Core Components<a class="headerlink" href="#core-components" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Points Service</strong> (<code>src/services/rewards/pointsService.ts</code>)</li>
<li><code>awardSeasonPoints()</code> - Primary method for awarding points (season-aware)</li>
<li><code>awardTransactionPoints()</code> - Transaction-specific point awards</li>
<li><code>recordPointsTransaction()</code> - Records points transactions in history</li>
<li>
<p><code>awardPoints()</code> - Deprecated legacy wrapper (redirects to <code>awardSeasonPoints()</code>)</p>
</li>
<li>
<p><strong>Quest Service</strong> (<code>src/services/rewards/questService.ts</code>)</p>
</li>
<li>Manages quest completion and rewards</li>
<li>Supports season-based and legacy quests</li>
<li>
<p>Handles quest validation and duplicate prevention</p>
</li>
<li>
<p><strong>Split Rewards Service</strong> (<code>src/services/rewards/splitRewardsService.ts</code>)</p>
</li>
<li>Fair Split rewards (owner bonus + participant rewards)</li>
<li>Degen Split rewards (winner/loser rewards)</li>
<li>
<p>Partnership-aware reward calculations</p>
</li>
<li>
<p><strong>Referral Service</strong> (<code>src/services/rewards/referralService.ts</code>)</p>
</li>
<li>Referral tracking and code generation</li>
<li>Account creation rewards</li>
<li>
<p>First split rewards</p>
</li>
<li>
<p><strong>Badge Service</strong> (<code>src/services/rewards/badgeService.ts</code>)</p>
</li>
<li>Achievement badge claims</li>
<li>Event badge claims (redeem codes)</li>
<li>
<p>Badge point awards</p>
</li>
<li>
<p><strong>Christmas Calendar Service</strong> (<code>src/services/rewards/christmasCalendarService.ts</code>)</p>
</li>
<li>Calendar gift claiming</li>
<li>Points, badges, and assets distribution</li>
<li>
<p>Atomic transaction handling</p>
</li>
<li>
<p><strong>Asset Service</strong> (<code>src/services/rewards/assetService.ts</code>)</p>
</li>
<li>Asset metadata retrieval</li>
<li>Database + config fallback</li>
<li>
<p>NFT support</p>
</li>
<li>
<p><strong>Season Service</strong> (<code>src/services/rewards/seasonService.ts</code>)</p>
</li>
<li>Current season determination</li>
<li>Season date management</li>
<li>Season-based calculations</li>
</ol>
<h3 id="configuration-files">Configuration Files<a class="headerlink" href="#configuration-files" title="Permanent link">&para;</a></h3>
<ul>
<li><code>seasonRewardsConfig.ts</code> - All reward values (single source of truth)</li>
<li><code>badgeConfig.ts</code> - Badge definitions</li>
<li><code>assetConfig.ts</code> - Asset definitions</li>
<li><code>referralConfig.ts</code> - Referral reward definitions</li>
<li><code>christmasCalendarConfig.ts</code> - Christmas calendar gifts</li>
</ul>
<hr />
<h2 id="points-sources">Points Sources<a class="headerlink" href="#points-sources" title="Permanent link">&para;</a></h2>
<h3 id="1-transaction-rewards">1. Transaction Rewards<a class="headerlink" href="#1-transaction-rewards" title="Permanent link">&para;</a></h3>
<p><strong>Service:</strong> <code>pointsService.awardTransactionPoints()</code><br />
<strong>Location:</strong> <code>src/services/rewards/pointsService.ts:22-116</code></p>
<p><strong>Integration Points:</strong>
- ✅ <code>transactionPostProcessing.ts:199</code> - Main transaction flow
- ✅ <code>userActionSyncService.ts:195</code> - Backfill for old transactions</p>
<p><strong>Configuration:</strong>
- Uses <code>seasonRewardsConfig.ts</code> - <code>transaction_1_1_request</code> task
- Season-based percentage: 8% (S1) → 4% (S5) for regular users
- Partnership: 15% (S1) → 8% (S5)
- Minimum amount: <code>MIN_TRANSACTION_AMOUNT_FOR_POINTS = $1</code></p>
<p><strong>Database Updates:</strong>
- ✅ <code>users.points</code> - Atomic update
- ✅ <code>users.total_points_earned</code> - Atomic update
- ✅ <code>points_transactions</code> - Record with <code>source: 'transaction_reward'</code>, <code>season</code>, <code>task_type</code></p>
<hr />
<h3 id="2-quest-completion-rewards">2. Quest Completion Rewards<a class="headerlink" href="#2-quest-completion-rewards" title="Permanent link">&para;</a></h3>
<p><strong>Service:</strong> <code>questService.completeQuest()</code><br />
<strong>Location:</strong> <code>src/services/rewards/questService.ts:149-307</code></p>
<p><strong>Active Season-Based Quests:</strong></p>
<table>
<thead>
<tr>
<th>Quest Type</th>
<th>Trigger</th>
<th>Points (S1-3)</th>
<th>Points (S4-5)</th>
<th>Integration</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>export_seed_phrase</code></td>
<td><code>userActionSyncService.syncSeedPhraseExport()</code></td>
<td>100</td>
<td>50</td>
<td>✅ Line 345</td>
</tr>
<tr>
<td><code>setup_account_pp</code></td>
<td><code>userActionSyncService.syncAccountSetupPP()</code></td>
<td>100</td>
<td>50</td>
<td>✅ Line 375</td>
</tr>
<tr>
<td><code>first_split_with_friends</code></td>
<td><code>userActionSyncService.syncFirstSplitWithFriends()</code></td>
<td>500</td>
<td>100</td>
<td>✅ Line 405</td>
</tr>
<tr>
<td><code>first_external_wallet_linked</code></td>
<td><code>userActionSyncService.syncExternalWalletLinking()</code></td>
<td>100</td>
<td>50</td>
<td>✅ Line 435</td>
</tr>
<tr>
<td><code>invite_friends_create_account</code></td>
<td><code>referralService.awardInviteFriendReward()</code></td>
<td>500</td>
<td>100</td>
<td>✅ Line 305</td>
</tr>
<tr>
<td><code>friend_do_first_split_over_10</code></td>
<td><code>referralService.awardFriendFirstSplitReward()</code></td>
<td>1000</td>
<td>500</td>
<td>✅ Line 382</td>
</tr>
</tbody>
</table>
<p><strong>Legacy Quests (Disabled):</strong>
- ❌ <code>profile_image</code> - DISABLED
- ❌ <code>first_transaction</code> - DISABLED
- ❌ <code>complete_onboarding</code> - DISABLED
- ❌ <code>add_first_contact</code> - DISABLED
- ❌ <code>create_first_split</code> - DISABLED</p>
<p><strong>Database Updates:</strong>
- ✅ <code>users/{userId}/quests/{questType}</code> - Quest completion record
- ✅ <code>users.points</code> - Updated via <code>awardSeasonPoints()</code>
- ✅ <code>points_transactions</code> - Record with <code>source: 'quest_completion'</code>, <code>season</code>, <code>task_type</code></p>
<hr />
<h3 id="3-split-participation-rewards">3. Split Participation Rewards<a class="headerlink" href="#3-split-participation-rewards" title="Permanent link">&para;</a></h3>
<p><strong>Service:</strong> <code>splitRewardsService.awardFairSplitParticipation()</code> / <code>awardDegenSplitParticipation()</code><br />
<strong>Location:</strong> <code>src/services/rewards/splitRewardsService.ts</code></p>
<p><strong>Fair Split Rewards:</strong>
- <strong>Owner Bonus:</strong> <code>create_fair_split_owner_bonus</code>
  - Regular: 10% (S1) → 50 fixed (S2-5)
  - Partnership: 20% (S1) → 100/50 fixed (S2-5)
- <strong>Participant:</strong> <code>participate_fair_split</code>
  - Regular: 8% (S1) → 4% (S5)
  - Partnership: 15% (S1) → 8% (S5)</p>
<p><strong>Degen Split Rewards:</strong>
- <strong>Winner:</strong> <code>degen_split_win</code>
  - Regular: 8% (S1) → 4% (S5)
  - Partnership: 15% (S1) → 8% (S5)
- <strong>Loser:</strong> <code>degen_split_lose</code>
  - Regular: 10% (S1) → 50 fixed (S2-5)
  - Partnership: 20% (S1) → 100/50 fixed (S2-5)</p>
<p><strong>Integration Points:</strong>
- ✅ <code>splitStorageService.ts:217</code> - Owner bonus on split creation
- ✅ <code>SplitWalletPayments.ts:2576</code> - Participant reward on payment
- ✅ <code>SplitWalletPayments.ts:2994</code> - Degen split winner/loser rewards (all participants)</p>
<hr />
<h3 id="4-referral-rewards">4. Referral Rewards<a class="headerlink" href="#4-referral-rewards" title="Permanent link">&para;</a></h3>
<p><strong>Service:</strong> <code>referralService.awardInviteFriendReward()</code> / <code>awardFriendFirstSplitReward()</code><br />
<strong>Location:</strong> <code>src/services/rewards/referralService.ts</code></p>
<p><strong>Referral Reward Types:</strong>
1. <strong><code>invite_friends_create_account</code></strong>
   - Trigger: Friend creates account
   - Points: 500 (S1-3) → 100 (S4-5)
   - Integration: ✅ <code>referralService.ts:305</code></p>
<ol>
<li><strong><code>friend_do_first_split_over_10</code></strong></li>
<li>Trigger: Friend does first split &gt; $10</li>
<li>Points: 1000 (S1-3) → 500 (S4-5)</li>
<li>Integration: ✅ <code>splitRewardsService.ts:80, 174</code></li>
</ol>
<hr />
<h3 id="5-badge-claim-rewards">5. Badge Claim Rewards<a class="headerlink" href="#5-badge-claim-rewards" title="Permanent link">&para;</a></h3>
<p><strong>Service:</strong> <code>badgeService.claimBadge()</code> / <code>claimEventBadge()</code><br />
<strong>Location:</strong> <code>src/services/rewards/badgeService.ts:539-843</code></p>
<p><strong>Badge Types with Points:</strong>
- Achievement badges: 50, 500, 2500, 10000 points (based on badge tier)
- Event badges: Variable points (defined in <code>badgeConfig.ts</code>)</p>
<p><strong>Integration Points:</strong>
- ✅ <code>badgeService.ts:599</code> - Achievement badges
- ✅ <code>badgeService.ts:785</code> - Event badges (redeem codes)</p>
<hr />
<h3 id="6-christmas-calendar-rewards">6. Christmas Calendar Rewards<a class="headerlink" href="#6-christmas-calendar-rewards" title="Permanent link">&para;</a></h3>
<p><strong>Service:</strong> <code>christmasCalendarService.claimGift()</code><br />
<strong>Location:</strong> <code>src/services/rewards/christmasCalendarService.ts:227-456</code></p>
<p><strong>Gift Types:</strong>
- <strong>Points:</strong> Direct addition to <code>users.points</code> (via Firestore transaction)
- <strong>Badges:</strong> Added to <code>users.badges[]</code>
- <strong>Assets:</strong> Added to <code>users.profile_assets[]</code> or <code>users.wallet_backgrounds[]</code></p>
<p><strong>Points Handling:</strong>
- ✅ Points added directly in Firestore transaction (line 344-348)
- ✅ Points transaction recorded via <code>recordPointsTransaction()</code> (line 426)
- ✅ Uses <code>recordPointsTransaction()</code> NOT <code>awardPoints()</code> - Correct to avoid double-counting</p>
<hr />
<h3 id="7-admin-adjustments">7. Admin Adjustments<a class="headerlink" href="#7-admin-adjustments" title="Permanent link">&para;</a></h3>
<p><strong>Service:</strong> <code>pointsService.awardSeasonPoints()</code> / <code>awardPoints()</code><br />
<strong>Source Type:</strong> <code>'admin_adjustment'</code><br />
<strong>Usage:</strong> Manual point adjustments by admins</p>
<hr />
<h2 id="claimable-assets">Claimable Assets<a class="headerlink" href="#claimable-assets" title="Permanent link">&para;</a></h2>
<h3 id="1-badges">1. Badges<a class="headerlink" href="#1-badges" title="Permanent link">&para;</a></h3>
<p><strong>Service:</strong> <code>badgeService</code><br />
<strong>Location:</strong> <code>src/services/rewards/badgeService.ts</code></p>
<p><strong>Badge Categories:</strong></p>
<h4 id="achievement-badges-progress-based">Achievement Badges (Progress-Based)<a class="headerlink" href="#achievement-badges-progress-based" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Split Withdrawals:</strong> 50, 500, 2500, 10000 splits</li>
<li><strong>Transaction Count:</strong> 50, 500, 2500, 10000 transactions</li>
<li><strong>Transaction Volume:</strong> $50, $500, $2500, $10000</li>
</ul>
<p><strong>Claim Method:</strong> <code>badgeService.claimBadge()</code><br />
<strong>Requirements:</strong> Progress must meet target</p>
<h4 id="event-badges-redeem-code">Event Badges (Redeem Code)<a class="headerlink" href="#event-badges-redeem-code" title="Permanent link">&para;</a></h4>
<ul>
<li>Christmas Calendar badges (9 badges)</li>
<li>Community badges (4 badges: WESPLIT, SUPERTEAMFRANCE, MONKEDAO, DIGGERS)</li>
</ul>
<p><strong>Claim Method:</strong> <code>badgeService.claimEventBadge()</code><br />
<strong>Requirements:</strong> Valid redeem code</p>
<p><strong>Database Storage:</strong>
- ✅ <code>users/{userId}/badges/{badgeId}</code> - Badge metadata
- ✅ <code>users.badges[]</code> - Array of badge IDs
- ✅ <code>users.active_badge</code> - Currently active badge</p>
<hr />
<h3 id="2-profile-assets">2. Profile Assets<a class="headerlink" href="#2-profile-assets" title="Permanent link">&para;</a></h3>
<p><strong>Service:</strong> <code>christmasCalendarService</code> / <code>assetService</code><br />
<strong>Location:</strong> <code>src/services/rewards/christmasCalendarService.ts</code> / <code>src/services/rewards/assetService.ts</code></p>
<p><strong>Asset Types:</strong>
1. <strong>Profile Images</strong> (<code>profile_image</code>)
   - Storage: <code>users.profile_assets[]</code>
   - Active: <code>users.active_profile_asset</code>
   - Examples: <code>profile_snowflake_2024</code>, <code>profile_reindeer_2024</code>, <code>profile_ornament_2024</code></p>
<ol>
<li><strong>Profile Borders</strong> (<code>profile_border</code>)</li>
<li>Storage: <code>users.profile_borders[]</code></li>
<li>Active: <code>users.active_profile_border</code></li>
<li>Examples: <code>profile_border_candycane_2024</code>, <code>profile_border_aurora_2024</code>, <code>profile_border_midnight_2024</code></li>
</ol>
<p><strong>Claim Methods:</strong>
- ✅ Christmas Calendar gifts (days 4, 11, 12, 15, 17, 18)
- ⚠️ <strong>MISSING:</strong> Direct asset purchase/claim mechanism (if needed)</p>
<p><strong>Database Storage:</strong>
- ✅ <code>users/{userId}/assets/{assetId}</code> - Asset metadata
- ✅ <code>users.profile_assets[]</code> - Array of profile image IDs
- ✅ <code>users.profile_borders[]</code> - Array of profile border IDs
- ✅ <code>users.active_profile_asset</code> - Currently active profile image
- ✅ <code>users.active_profile_border</code> - Currently active profile border</p>
<hr />
<h3 id="3-wallet-backgrounds">3. Wallet Backgrounds<a class="headerlink" href="#3-wallet-backgrounds" title="Permanent link">&para;</a></h3>
<p><strong>Service:</strong> <code>christmasCalendarService</code> / <code>assetService</code><br />
<strong>Location:</strong> <code>src/services/rewards/christmasCalendarService.ts</code> / <code>src/services/rewards/assetService.ts</code></p>
<p><strong>Asset Type:</strong> <code>wallet_background</code><br />
<strong>Storage:</strong> <code>users.wallet_backgrounds[]</code><br />
<strong>Active:</strong> <code>users.active_wallet_background</code></p>
<p><strong>Examples:</strong>
- <code>wallet_winter_2024</code>, <code>wallet_christmas_2024</code>, <code>wallet_solstice_2024</code>, <code>wallet_northpole_2024</code></p>
<p><strong>Claim Methods:</strong>
- ✅ Christmas Calendar gifts (days 7, 14, 19, 21)
- ⚠️ <strong>MISSING:</strong> Direct asset purchase/claim mechanism (if needed)</p>
<p><strong>Note:</strong> Wallet backgrounds are stored but not currently displayed in UI (display location TBD).</p>
<hr />
<h2 id="configuration-management">Configuration Management<a class="headerlink" href="#configuration-management" title="Permanent link">&para;</a></h2>
<h3 id="single-source-of-truth">Single Source of Truth<a class="headerlink" href="#single-source-of-truth" title="Permanent link">&para;</a></h3>
<p><strong>ALL reward values are defined in ONE file:</strong>
- <code>src/services/rewards/seasonRewardsConfig.ts</code></p>
<p><strong>DO NOT:</strong>
- ❌ Hardcode reward values anywhere else in the codebase
- ❌ Create duplicate configuration files
- ❌ Modify reward values in service files</p>
<p><strong>DO:</strong>
- ✅ Edit values only in <code>seasonRewardsConfig.ts</code>
- ✅ Use the provided helper functions to get rewards
- ✅ Test changes after modifying rewards</p>
<h3 id="configuration-files_1">Configuration Files<a class="headerlink" href="#configuration-files_1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Configuration</th>
<th>File</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td>Reward Values</td>
<td><code>seasonRewardsConfig.ts</code></td>
<td>✅ Centralized</td>
</tr>
<tr>
<td>Badge Definitions</td>
<td><code>badgeConfig.ts</code></td>
<td>✅ Centralized</td>
</tr>
<tr>
<td>Asset Definitions</td>
<td><code>assetConfig.ts</code></td>
<td>✅ Centralized</td>
</tr>
<tr>
<td>Referral Rewards</td>
<td><code>referralConfig.ts</code></td>
<td>✅ Centralized</td>
</tr>
<tr>
<td>Christmas Gifts</td>
<td><code>christmasCalendarConfig.ts</code></td>
<td>✅ Centralized</td>
</tr>
</tbody>
</table>
<h3 id="season-configuration">Season Configuration<a class="headerlink" href="#season-configuration" title="Permanent link">&para;</a></h3>
<p><strong>Season Dates:</strong>
- <strong>Season 1</strong>: Jan 1, 2024 - Mar 31, 2024
- <strong>Season 2</strong>: Apr 1, 2024 - Jun 30, 2024
- <strong>Season 3</strong>: Jul 1, 2024 - Sep 30, 2024
- <strong>Season 4</strong>: Oct 1, 2024 - Dec 31, 2024
- <strong>Season 5</strong>: Jan 1, 2025 - Dec 31, 2025</p>
<h3 id="reward-types">Reward Types<a class="headerlink" href="#reward-types" title="Permanent link">&para;</a></h3>
<h4 id="fixed-points">Fixed Points<a class="headerlink" href="#fixed-points" title="Permanent link">&para;</a></h4>
<p>Award a specific number of points regardless of transaction/split amount.</p>
<p><strong>Example:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nx">export_seed_phrase</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">  </span><span class="mf">1</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;fixed&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// Always awards 100 points</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">}</span>
</code></pre></div></p>
<h4 id="percentage-based">Percentage-Based<a class="headerlink" href="#percentage-based" title="Permanent link">&para;</a></h4>
<p>Calculate points as a percentage of the transaction/split amount.</p>
<p><strong>Example:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nx">transaction_1_1_request</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="mf">1</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;percentage&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">8</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// Awards 8% of transaction amount</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="p">}</span>
</code></pre></div></p>
<p><strong>Calculation:</strong>
- $100 transaction × 8% = 8 points
- $50 transaction × 8% = 4 points</p>
<hr />
<h2 id="validation-system">Validation System<a class="headerlink" href="#validation-system" title="Permanent link">&para;</a></h2>
<h3 id="validation-functions">Validation Functions<a class="headerlink" href="#validation-functions" title="Permanent link">&para;</a></h3>
<p>All configuration files have validation functions:</p>
<ol>
<li><strong><code>validateRewardConfig()</code></strong> - <code>seasonRewardsConfig.ts</code></li>
<li>Validates all season rewards (1-5)</li>
<li>Validates partnership rewards</li>
<li>
<p>Checks for missing rewards, invalid types, negative values, percentage &gt; 100%</p>
</li>
<li>
<p><strong><code>validateBadgeConfig()</code></strong> - <code>badgeConfig.ts</code></p>
</li>
<li>Validates required fields (badgeId, title, description, icon)</li>
<li>Validates rarity, points, targets</li>
<li>Validates achievement badge requirements</li>
<li>
<p>Validates event/community badge requirements</p>
</li>
<li>
<p><strong><code>validateAssetConfig()</code></strong> - <code>assetConfig.ts</code></p>
</li>
<li>Validates required fields (assetId, name, description, assetType)</li>
<li>Validates rarity, URLs, NFT metadata</li>
<li>
<p>Ensures assets have either URL or NFT metadata</p>
</li>
<li>
<p><strong><code>validateReferralConfig()</code></strong> - <code>referralConfig.ts</code></p>
</li>
<li>Validates required fields (rewardId, taskType, trigger, description)</li>
<li>Checks for duplicate reward IDs</li>
<li>Validates trigger-specific requirements</li>
<li>Validates condition values</li>
</ol>
<h3 id="validation-runner">Validation Runner<a class="headerlink" href="#validation-runner" title="Permanent link">&para;</a></h3>
<p><strong>File:</strong> <code>src/services/rewards/configValidationRunner.ts</code></p>
<p><strong>Functions:</strong>
- <code>validateAllRewardConfigs()</code> - Validates all configs
- <code>areAllConfigsValid()</code> - Quick check if all valid
- <code>getAllValidationErrors()</code> - Get all errors</p>
<h3 id="running-validation">Running Validation<a class="headerlink" href="#running-validation" title="Permanent link">&para;</a></h3>
<p><strong>CLI Script:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>npm<span class="w"> </span>run<span class="w"> </span>validate:rewards
</code></pre></div></p>
<p><strong>Programmatic:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">validateAllRewardConfigs</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./services/rewards/configValidationRunner&#39;</span><span class="p">;</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">validateAllRewardConfigs</span><span class="p">();</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="nx">results</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">result</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">isValid</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`</span><span class="si">${</span><span class="nx">result</span><span class="p">.</span><span class="nx">configName</span><span class="si">}</span><span class="sb"> errors:`</span><span class="p">,</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">errors</span><span class="p">);</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="p">});</span>
</code></pre></div></p>
<hr />
<h2 id="implementation-guide">Implementation Guide<a class="headerlink" href="#implementation-guide" title="Permanent link">&para;</a></h2>
<h3 id="awarding-transaction-points">Awarding Transaction Points<a class="headerlink" href="#awarding-transaction-points" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">pointsService</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./services/rewards/pointsService&#39;</span><span class="p">;</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c1">// Automatically uses current season and user&#39;s partnership status</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">pointsService</span><span class="p">.</span><span class="nx">awardTransactionPoints</span><span class="p">(</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">  </span><span class="nx">userId</span><span class="p">,</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">  </span><span class="nx">transactionAmount</span><span class="p">,</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">  </span><span class="nx">transactionId</span><span class="p">,</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">  </span><span class="s1">&#39;send&#39;</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="p">);</span>
</code></pre></div>
<h3 id="awarding-split-participation-rewards">Awarding Split Participation Rewards<a class="headerlink" href="#awarding-split-participation-rewards" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">splitRewardsService</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./services/rewards/splitRewardsService&#39;</span><span class="p">;</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="c1">// Fair Split</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">splitRewardsService</span><span class="p">.</span><span class="nx">awardFairSplitParticipation</span><span class="p">({</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">  </span><span class="nx">userId</span><span class="p">,</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">  </span><span class="nx">splitId</span><span class="p">,</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">  </span><span class="nx">splitType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;fair&#39;</span><span class="p">,</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">  </span><span class="nx">splitAmount</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span><span class="p">,</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">  </span><span class="nx">isOwner</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="p">});</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="c1">// Degen Split</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">splitRewardsService</span><span class="p">.</span><span class="nx">awardDegenSplitParticipation</span><span class="p">({</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">  </span><span class="nx">userId</span><span class="p">,</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">  </span><span class="nx">splitId</span><span class="p">,</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">  </span><span class="nx">splitType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;degen&#39;</span><span class="p">,</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">  </span><span class="nx">splitAmount</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span><span class="p">,</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">  </span><span class="nx">isOwner</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">  </span><span class="nx">isWinner</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="p">});</span>
</code></pre></div>
<h3 id="tracking-referrals">Tracking Referrals<a class="headerlink" href="#tracking-referrals" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">referralService</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./services/rewards/referralService&#39;</span><span class="p">;</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="c1">// Track referral when user signs up</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">referralService</span><span class="p">.</span><span class="nx">trackReferral</span><span class="p">(</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">  </span><span class="nx">newUserId</span><span class="p">,</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">  </span><span class="nx">referralCode</span><span class="p">,</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">  </span><span class="nx">referrerId</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="p">);</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="c1">// Award points when friend does first split &gt; $10</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="k">await</span><span class="w"> </span><span class="nx">referralService</span><span class="p">.</span><span class="nx">awardFriendFirstSplitReward</span><span class="p">(</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">  </span><span class="nx">referrerId</span><span class="p">,</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">  </span><span class="nx">referredUserId</span><span class="p">,</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w">  </span><span class="nx">splitAmount</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="p">);</span>
</code></pre></div>
<h3 id="syncing-user-actions">Syncing User Actions<a class="headerlink" href="#syncing-user-actions" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">userActionSyncService</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./services/rewards/userActionSyncService&#39;</span><span class="p">;</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="c1">// Sync seed phrase export</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="k">await</span><span class="w"> </span><span class="nx">userActionSyncService</span><span class="p">.</span><span class="nx">syncSeedPhraseExport</span><span class="p">(</span><span class="nx">userId</span><span class="p">);</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="c1">// Sync external wallet linking</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="k">await</span><span class="w"> </span><span class="nx">userActionSyncService</span><span class="p">.</span><span class="nx">syncExternalWalletLinking</span><span class="p">(</span><span class="nx">userId</span><span class="p">);</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="c1">// Sync first split with friends</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="k">await</span><span class="w"> </span><span class="nx">userActionSyncService</span><span class="p">.</span><span class="nx">syncFirstSplitWithFriends</span><span class="p">(</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">  </span><span class="nx">userId</span><span class="p">,</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">  </span><span class="nx">splitId</span><span class="p">,</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">  </span><span class="nx">participantCount</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="p">);</span>
</code></pre></div>
<h3 id="integration-points">Integration Points<a class="headerlink" href="#integration-points" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Transaction Completion</strong></li>
<li>Already integrated in <code>ConsolidatedTransactionService</code> and <code>sendInternal.ts</code></li>
<li>
<p>Automatically uses season-based rewards</p>
</li>
<li>
<p><strong>Split Creation</strong></p>
</li>
<li>Call <code>splitRewardsService.awardFairSplitParticipation()</code> after creating a Fair Split</li>
<li>Call <code>splitRewardsService.awardDegenSplitParticipation()</code> after Degen Split completion</li>
<li>
<p>Call <code>userActionSyncService.syncFirstSplitWithFriends()</code> for first split with friends</p>
</li>
<li>
<p><strong>User Registration</strong></p>
</li>
<li>Call <code>referralService.trackReferral()</code> when new user signs up</li>
<li>
<p>Call <code>userActionSyncService.syncAccountSetupPP()</code> after onboarding</p>
</li>
<li>
<p><strong>Seed Phrase Export</strong></p>
</li>
<li>
<p>Call <code>userActionSyncService.syncSeedPhraseExport()</code> after user exports seed phrase</p>
</li>
<li>
<p><strong>External Wallet Linking</strong></p>
</li>
<li>Call <code>userActionSyncService.syncExternalWalletLinking()</code> after linking external wallet</li>
</ol>
<hr />
<h2 id="maintenance-guide">Maintenance Guide<a class="headerlink" href="#maintenance-guide" title="Permanent link">&para;</a></h2>
<h3 id="quick-start-editing-rewards">Quick Start: Editing Rewards<a class="headerlink" href="#quick-start-editing-rewards" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Open the Configuration File</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>src/services/rewards/seasonRewardsConfig.ts
</code></pre></div></p>
</li>
<li>
<p><strong>Find the Task You Want to Edit</strong></p>
</li>
</ol>
<p>The file is organized by task categories:
   - <strong>Get Started Tasks</strong>: <code>export_seed_phrase</code>, <code>setup_account_pp</code>, <code>first_split_with_friends</code>, <code>first_external_wallet_linked</code>
   - <strong>Referral Tasks</strong>: <code>invite_friends_create_account</code>, <code>friend_do_first_split_over_10</code>
   - <strong>All Tasks</strong> (Regular Users): <code>transaction_1_1_request</code>, <code>participate_fair_split</code>, <code>create_fair_split_owner_bonus</code>, <code>degen_split_win</code>, <code>degen_split_lose</code>
   - <strong>Partnership Tasks</strong>: Same as "All Tasks" but with enhanced values</p>
<ol>
<li><strong>Edit the Value</strong></li>
</ol>
<p><strong>Example 1: Change Fixed Points</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nx">export_seed_phrase</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">  </span><span class="mf">1</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;fixed&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">150</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="c1">// Changed from 100 to 150</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">  </span><span class="mf">2</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;fixed&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">100</span><span class="w"> </span><span class="p">},</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">  </span><span class="c1">// ...</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="p">}</span>
</code></pre></div></p>
<p><strong>Example 2: Change Percentage</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nx">transaction_1_1_request</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">  </span><span class="mf">1</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;percentage&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">10</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="c1">// Changed from 8 to 10</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">  </span><span class="mf">2</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;percentage&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">7</span><span class="w"> </span><span class="p">},</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">  </span><span class="c1">// ...</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="p">}</span>
</code></pre></div></p>
<ol>
<li><strong>Validate Your Changes</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>npm<span class="w"> </span>run<span class="w"> </span>validate:rewards
</code></pre></div></li>
</ol>
<h3 id="helper-functions">Helper Functions<a class="headerlink" href="#helper-functions" title="Permanent link">&para;</a></h3>
<p><strong>Get Reward for a Task:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">getSeasonReward</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./services/rewards/seasonRewardsConfig&#39;</span><span class="p">;</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">seasonService</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./services/rewards/seasonService&#39;</span><span class="p">;</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="kd">const</span><span class="w"> </span><span class="nx">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">seasonService</span><span class="p">.</span><span class="nx">getCurrentSeason</span><span class="p">();</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="kd">const</span><span class="w"> </span><span class="nx">isPartnership</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">user</span><span class="p">.</span><span class="nx">is_partnership</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="kd">const</span><span class="w"> </span><span class="nx">reward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getSeasonReward</span><span class="p">(</span><span class="s1">&#39;transaction_1_1_request&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">season</span><span class="p">,</span><span class="w"> </span><span class="nx">isPartnership</span><span class="p">);</span>
</code></pre></div></p>
<p><strong>Calculate Points:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">calculateRewardPoints</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./services/rewards/seasonRewardsConfig&#39;</span><span class="p">;</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">reward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getSeasonReward</span><span class="p">(</span><span class="s1">&#39;transaction_1_1_request&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">season</span><span class="p">,</span><span class="w"> </span><span class="nx">isPartnership</span><span class="p">);</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="kd">const</span><span class="w"> </span><span class="nx">transactionAmount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="kd">const</span><span class="w"> </span><span class="nx">points</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">calculateRewardPoints</span><span class="p">(</span><span class="nx">reward</span><span class="p">,</span><span class="w"> </span><span class="nx">transactionAmount</span><span class="p">);</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="c1">// For percentage: 100 × 8% = 8 points</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="c1">// For fixed: returns the fixed value directly</span>
</code></pre></div></p>
<h3 id="validation-rules">Validation Rules<a class="headerlink" href="#validation-rules" title="Permanent link">&para;</a></h3>
<p>The system automatically validates:
1. <strong>All seasons must have rewards</strong> - No missing values
2. <strong>Reward type must be valid</strong> - Either 'fixed' or 'percentage'
3. <strong>Values must be non-negative</strong> - No negative points
4. <strong>Percentages must be ≤ 100%</strong> - No percentages over 100%</p>
<hr />
<h2 id="verification-status">Verification &amp; Status<a class="headerlink" href="#verification-status" title="Permanent link">&para;</a></h2>
<h3 id="points-award-method-consolidation">Points Award Method Consolidation ✅<a class="headerlink" href="#points-award-method-consolidation" title="Permanent link">&para;</a></h3>
<p><strong>Status:</strong> ✅ <strong>Complete</strong></p>
<ul>
<li><code>awardSeasonPoints()</code> - Primary method (season optional, defaults to current)</li>
<li><code>awardPoints()</code> - Deprecated wrapper (redirects to <code>awardSeasonPoints()</code>)</li>
<li>All usages verified and updated</li>
</ul>
<h3 id="validation-functions_1">Validation Functions ✅<a class="headerlink" href="#validation-functions_1" title="Permanent link">&para;</a></h3>
<p><strong>Status:</strong> ✅ <strong>Complete</strong></p>
<ul>
<li>All 4 config files have validation functions</li>
<li>Validation runner created</li>
<li>CLI script available (<code>npm run validate:rewards</code>)</li>
</ul>
<h3 id="direct-database-updates">Direct Database Updates ✅<a class="headerlink" href="#direct-database-updates" title="Permanent link">&para;</a></h3>
<p><strong>Status:</strong> ✅ <strong>Verified</strong></p>
<ul>
<li>Christmas Calendar: Intentional direct update (atomicity)</li>
<li>Points Service: Centralized method</li>
<li>User Initialization: Only for new users</li>
<li>No unauthorized direct updates found</li>
</ul>
<h3 id="integration-points_1">Integration Points ✅<a class="headerlink" href="#integration-points_1" title="Permanent link">&para;</a></h3>
<p><strong>Status:</strong> ✅ <strong>All Verified</strong></p>
<ul>
<li>Transaction rewards: ✅ Properly integrated</li>
<li>Quest completion: ✅ Properly integrated</li>
<li>Split rewards: ✅ Properly integrated</li>
<li>Referral rewards: ✅ Properly integrated</li>
<li>Badge claims: ✅ Properly integrated</li>
<li>Christmas Calendar: ✅ Properly integrated</li>
</ul>
<h3 id="critical-issues">Critical Issues<a class="headerlink" href="#critical-issues" title="Permanent link">&para;</a></h3>
<h4 id="asset-placeholder-urls-critical">⚠️ Asset Placeholder URLs (CRITICAL)<a class="headerlink" href="#asset-placeholder-urls-critical" title="Permanent link">&para;</a></h4>
<p><strong>Issue:</strong> All asset URLs in configuration files are placeholders:
- <code>https://example.com/assets/profile_snowflake.png</code>
- <code>https://example.com/assets/wallet_winter.png</code>
- etc.</p>
<p><strong>Files Affected:</strong>
- <code>src/services/rewards/christmasCalendarConfig.ts</code> - Lines 72, 112, 163, 203, 254, 294
- <code>src/services/rewards/assetConfig.ts</code> - Lines 48, 57, 66, 77, 86, 95</p>
<p><strong>Action Required:</strong>
1. Upload all asset images to CDN/storage
2. Replace placeholder URLs with production URLs
3. Verify all asset images load correctly
4. Test asset display in UI components</p>
<p><strong>Priority:</strong> 🔴 <strong>CRITICAL</strong> - Must fix before production</p>
<hr />
<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<h3 id="code-organization">Code Organization ✅<a class="headerlink" href="#code-organization" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Single Source of Truth:</strong></li>
<li>All reward values in <code>seasonRewardsConfig.ts</code></li>
<li>All asset definitions in <code>assetConfig.ts</code></li>
<li>All badge definitions in <code>badgeConfig.ts</code></li>
<li>All calendar gifts in <code>christmasCalendarConfig.ts</code></li>
<li>
<p>All referral rewards in <code>referralConfig.ts</code></p>
</li>
<li>
<p><strong>Service Layer Pattern:</strong></p>
</li>
<li>Each reward type has dedicated service</li>
<li>Clear separation of concerns</li>
<li>Proper dependency injection</li>
</ol>
<h3 id="error-handling">Error Handling ✅<a class="headerlink" href="#error-handling" title="Permanent link">&para;</a></h3>
<p><strong>Comprehensive Error Handling:</strong>
- ✅ All async operations wrapped in try-catch blocks
- ✅ Graceful error returns with error messages
- ✅ Fallback mechanisms for asset retrieval
- ✅ Validation before operations
- ✅ Logging for all errors with context</p>
<h3 id="data-integrity">Data Integrity ✅<a class="headerlink" href="#data-integrity" title="Permanent link">&para;</a></h3>
<p><strong>Atomic Operations:</strong>
- ✅ All point updates use Firestore transactions or atomic updates
- ✅ Calendar gift claiming uses Firestore transactions
- ✅ Quest completion uses rollback on failure
- ✅ Asset claiming uses atomic transactions</p>
<p><strong>Duplicate Prevention:</strong>
- ✅ Quest completion checks <code>isQuestCompleted()</code> before awarding
- ✅ Transaction points check <code>points_transactions</code> for existing <code>source_id</code>
- ✅ Referral rewards check <code>rewardsAwarded</code> flags
- ✅ Calendar claims check <code>isDayClaimed()</code> before claiming</p>
<h3 id="logging-monitoring">Logging &amp; Monitoring ✅<a class="headerlink" href="#logging-monitoring" title="Permanent link">&para;</a></h3>
<p><strong>Comprehensive Logging:</strong>
- ✅ All point awards logged with context
- ✅ All errors logged with stack traces
- ✅ All warnings logged for edge cases
- ✅ All operations logged for debugging</p>
<h3 id="type-safety">Type Safety ✅<a class="headerlink" href="#type-safety" title="Permanent link">&para;</a></h3>
<p><strong>TypeScript Types:</strong>
- ✅ All interfaces defined for reward types
- ✅ Type-safe reward lookups with <code>RewardTask</code> enum
- ✅ Type-safe season with <code>Season</code> type (1-5)
- ✅ Type-safe asset types with union types
- ✅ Compile-time error checking</p>
<h3 id="non-blocking-operations">Non-Blocking Operations ✅<a class="headerlink" href="#non-blocking-operations" title="Permanent link">&para;</a></h3>
<p><strong>Non-Blocking Reward Integration:</strong>
- ✅ All reward operations are non-blocking
- ✅ Reward failures don't break core functionality
- ✅ Background sync for quest completion
- ✅ Async operations with proper error handling</p>
<hr />
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<h3 id="issue-changes-not-applying">Issue: Changes not applying<a class="headerlink" href="#issue-changes-not-applying" title="Permanent link">&para;</a></h3>
<p><strong>Solution:</strong> Ensure you're editing <code>seasonRewardsConfig.ts</code> and not a cached version. Restart the development server.</p>
<h3 id="issue-validation-errors">Issue: Validation errors<a class="headerlink" href="#issue-validation-errors" title="Permanent link">&para;</a></h3>
<p><strong>Solution:</strong> Check that:
- All seasons (1-5) have values
- Reward types are 'fixed' or 'percentage'
- Values are non-negative
- Percentages are ≤ 100</p>
<h3 id="issue-wrong-reward-type">Issue: Wrong reward type<a class="headerlink" href="#issue-wrong-reward-type" title="Permanent link">&para;</a></h3>
<p><strong>Solution:</strong> Ensure you're using the correct task name and checking partnership status correctly.</p>
<h3 id="issue-asset-urls-not-loading">Issue: Asset URLs not loading<a class="headerlink" href="#issue-asset-urls-not-loading" title="Permanent link">&para;</a></h3>
<p><strong>Solution:</strong> 
1. Verify asset URLs are production URLs (not placeholders)
2. Check CDN/storage accessibility
3. Verify image format and size
4. Check network connectivity</p>
<h3 id="issue-points-not-awarded">Issue: Points not awarded<a class="headerlink" href="#issue-points-not-awarded" title="Permanent link">&para;</a></h3>
<p><strong>Solution:</strong>
1. Check logs for error messages
2. Verify user exists in database
3. Verify transaction amount meets minimum ($1)
4. Verify quest/split/referral conditions are met
5. Check if points were already awarded (duplicate prevention)</p>
<hr />
<h2 id="summary-statistics">Summary Statistics<a class="headerlink" href="#summary-statistics" title="Permanent link">&para;</a></h2>
<h3 id="integration-points_2">Integration Points<a class="headerlink" href="#integration-points_2" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Total Integration Points:</strong> 17</li>
<li><strong>Verified Integration Points:</strong> 17 (100%)</li>
<li><strong>Transaction Rewards:</strong> 3 triggers</li>
<li><strong>Quest Completion:</strong> 11 quest types</li>
<li><strong>Split Rewards:</strong> 3 triggers</li>
<li><strong>Referral Rewards:</strong> 2 triggers</li>
<li><strong>Christmas Calendar:</strong> 1 trigger</li>
</ul>
<h3 id="database-flags">Database Flags<a class="headerlink" href="#database-flags" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>User Document Flags:</strong> 15 flags</li>
<li><strong>Quest Flags:</strong> 3 flags per quest type</li>
<li><strong>Referral Flags:</strong> 5 flags</li>
<li><strong>Points Transaction Flags:</strong> 7 flags</li>
<li><strong>Christmas Calendar Flags:</strong> 6 flags per day + 6 flags per claim</li>
<li><strong>Asset Metadata:</strong> Stored in subcollection</li>
</ul>
<h3 id="code-coverage">Code Coverage<a class="headerlink" href="#code-coverage" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Point Award Methods:</strong> 3 methods (100% coverage)</li>
<li><strong>Quest Types:</strong> 11 quest types (100% coverage)</li>
<li><strong>Split Reward Types:</strong> 2 types (100% coverage)</li>
<li><strong>Referral Reward Types:</strong> 2 types (100% coverage)</li>
<li><strong>Asset Types:</strong> 3 types (badges, profile assets, wallet backgrounds)</li>
<li><strong>Display Components:</strong> 2 components (BadgeDisplay, ProfileAssetDisplay)</li>
</ul>
<hr />
<h2 id="action-items">Action Items<a class="headerlink" href="#action-items" title="Permanent link">&para;</a></h2>
<h3 id="completed">Completed ✅<a class="headerlink" href="#completed" title="Permanent link">&para;</a></h3>
<ul>
<li>[x] Consolidate points award methods</li>
<li>[x] Add validation functions for all configs</li>
<li>[x] Create validation runner</li>
<li>[x] Create system verification service</li>
<li>[x] Fix Christmas Calendar season tracking</li>
<li>[x] Verify all integration points</li>
<li>[x] Document complete system</li>
</ul>
<h3 id="pending">Pending ⚠️<a class="headerlink" href="#pending" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] Replace asset placeholder URLs with production URLs (CRITICAL)</li>
<li>[ ] Add validation to CI/CD pipeline</li>
<li>[ ] Add validation to app startup (dev mode)</li>
<li>[ ] Create unit tests for validation</li>
<li>[ ] Implement wallet background display (if needed)</li>
<li>[ ] Add badge/asset display to additional screens (enhancement)</li>
</ul>
<hr />
<h2 id="file-locations">File Locations<a class="headerlink" href="#file-locations" title="Permanent link">&para;</a></h2>
<h3 id="core-services">Core Services<a class="headerlink" href="#core-services" title="Permanent link">&para;</a></h3>
<ul>
<li><code>src/services/rewards/pointsService.ts</code> - Points awarding</li>
<li><code>src/services/rewards/questService.ts</code> - Quest management</li>
<li><code>src/services/rewards/splitRewardsService.ts</code> - Split rewards</li>
<li><code>src/services/rewards/referralService.ts</code> - Referral system</li>
<li><code>src/services/rewards/badgeService.ts</code> - Badge management</li>
<li><code>src/services/rewards/christmasCalendarService.ts</code> - Calendar gifts</li>
<li><code>src/services/rewards/assetService.ts</code> - Asset retrieval</li>
<li><code>src/services/rewards/seasonService.ts</code> - Season management</li>
</ul>
<h3 id="configuration-files_2">Configuration Files<a class="headerlink" href="#configuration-files_2" title="Permanent link">&para;</a></h3>
<ul>
<li><code>src/services/rewards/seasonRewardsConfig.ts</code> - Reward values</li>
<li><code>src/services/rewards/badgeConfig.ts</code> - Badge definitions</li>
<li><code>src/services/rewards/assetConfig.ts</code> - Asset definitions</li>
<li><code>src/services/rewards/referralConfig.ts</code> - Referral rewards</li>
<li><code>src/services/rewards/christmasCalendarConfig.ts</code> - Calendar gifts</li>
</ul>
<h3 id="validation-verification">Validation &amp; Verification<a class="headerlink" href="#validation-verification" title="Permanent link">&para;</a></h3>
<ul>
<li><code>src/services/rewards/configValidationRunner.ts</code> - Validation runner</li>
<li><code>src/services/rewards/rewardSystemVerification.ts</code> - System verification</li>
<li><code>tools/scripts/validate-reward-configs.ts</code> - CLI validation script</li>
</ul>
<h3 id="documentation">Documentation<a class="headerlink" href="#documentation" title="Permanent link">&para;</a></h3>
<ul>
<li><code>docs/REWARD_SYSTEM_COMPREHENSIVE_DOCUMENTATION.md</code> - This document</li>
</ul>
<hr />
<p><strong>Document Created:</strong> 2024-12-19<br />
<strong>Last Updated:</strong> 2024-12-19<br />
<strong>Status:</strong> ✅ Complete<br />
<strong>Next Review:</strong> 2025-01-19 (Monthly)</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="January 14, 2026 11:39:08 UTC">January 14, 2026</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.annotate"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>